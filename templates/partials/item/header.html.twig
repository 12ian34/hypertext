{% set show_image = page.header.show_header_image ?? true %}
{% set header_image = page.media.images[page.header.header_image_file] ?? page.media.images|first ?? false %}
{% set show_subtitle = parent.header.render.children.subtitle ?? true %}
{% set show_cat = parent.header.render.children.category ?? true %}
{% set show_date = parent.header.render.children.date ?? false %}

{# ------------------------------------------------------------------------ #}

{# Title & Subtitle #}
<h3>
  <a href="{{ page.url }}">{{ page.title }}</a>
  {% if page.header.subtitle and show_subtitle %} - <small>{{ page.header.subtitle }}</small>{% endif %}
</h3>

<p> {# The next set of items should be somewhat close together.}

{# Image #}
{% if show_image and header_image %}
  {% if style.image_cropping|default(false) %}
    <a href="{{ page.url }}">{{ header_image.cropZoom((style.width / 2) - 10, style.width / 5).html() }}</a>
  {% else %}
    <a href="{{ page.url }}">{{ header_image.html() }}</a>
  {% endif %}
{% endif %}

{# Date #}
{% if show_date %}
<br><sub>
  {% if html5 %}
    <time datetime="{{ page.date|date("c") }}">{{ page.date|date(system.pages.dateformat.short) }}</time>
  {% else %}
    <span class="datetime">{{ page.date|date(system.pages.dateformat.short) }}</span>
  {% endif %}
</sub>
{% endif %}

{# Categories #}
{% if page.taxonomy.category and show_cat %}
<br>
  Categories: <small>
  {% for category in page.taxonomy.category %}
    {{ structure.use_decorators ? '[' : '' }}<a href="{{ page.parent.url|rtrim('/') }}/category{{ config.system.param_sep }}{{ category }}">{{ category }}</a>{{ structure.use_decorators ? ']' : '' }}{{ not loop.last ? ',' : '' }}
  {% endfor %}</small></p>
{% else %}
{% endif %}

</p>

{# Date #}
{% if structure.show_date %}
<p align="right"><sub>
  {% if html5 %}
    <time datetime="{{ page.date|date("c") }}">{{ page.date|date(system.pages.dateformat.short) }}</time>
  {% else %}
    <span class="datetime">{{ page.date|date(system.pages.dateformat.short) }}</span>
  {% endif %}
</sub></p>
{% endif %}

{# Titles #}
{% if not page.home() %}
<h2><a href="{{ page.url }}">{{ page.title }}</a>{% if page.header.subtitle %}<small> - {{ page.header.subtitle }}</small>{% endif %}</h2>
{% endif %}

{# Taxonomies #}
{% if page.taxonomy.category %}
  <span class="categories">
  Categories: 
  {% for category in page.taxonomy.category %}
    <a href="{{ blog.url|rtrim('/') }}/category{{ config.system.param_sep }}{{ category }}">{{ category }}</a>
  {% endfor %}
  </span>
{% endif %}

{% if page.taxonomy.tag %}
  <br/>
  <span class="tags">
  Tags: 
  {% for tag in page.taxonomy.tag %}
    <a href="{{ blog.url|rtrim('/') }}/tag{{ config.system.param_sep }}{{ tag }}">{{ tag }}</a>
  {% endfor %}
  </span>
{% endif %}

{# Header Image #}
{% if style.image_cropping|default(false) %}
    <p>{{ page.media[header_image_file].cropZoom(style.width - 10, style.width / 5).html() }}</p>
  {% else %}
    <p>{{ page.media[header_image_file].html() }}</p>
{% endif %}